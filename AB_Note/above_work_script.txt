1 . GM8126 part
tftp 0x4000000 bootstrap
go 0x4000000
mount -o nolock 192.168.214.28:/esproot /mnt/nfs

#update fireware
dd if=nsboot.img of=/dev/mtdblock0
dd if=burnin.img of=/dev/mtdblock1
dd if=u-boot.img of=/dev/mtdblock2
dd if=linux.img of=/dev/mtdblock3
dd if=rootfs.bin of=/dev/mtdblock4
dd if=/dev/zero of=/dev/mtdblock5 count=512 bs=1024
dd if=mp.tgz of=/dev/mtdblock6

编译内核及文件系统：
#####################################
#如果要全部重新编译的话，在编译之前要将build文件
夹里面的东西全部删掉
cd core
make defconfig
cp configs/ESP2_GM8126_defconfig .config

make menuconfig -->
 package selection for the target--->
 GM8126 linux kernel

       --> PTZ
make

编译内核及文件系统：
#####################################
#如果要全部重新编译的话，在编译之前要将build文件
夹里面的东西全部删掉
cd core
make defconfig
cp configs/ESP2_GM8126_defconfig .config

make menuconfig -->
 package selection for the target--->
 GM8126 linux kernel

       --> PTZ
make

##git 的使用
git clone ssh://hai_li@dev.ppcam.tv:29418/esp/core.git
git checkout
git add	**
git checkout **

scp -p -P 29418 hai_li@dev.ppcam.tv:hooks/commit-msg .git/hooks
git commit -a -m "***"
git commit --amend

git checkout branchname
git reset ****

git reset --hard dd3ea7d135aee30d75f92349d48c252790cf6f90(回到上一版本号)

git push ssh://dylan_fan@dev.ppcam.tv:29418/esp/core HEAD:refs/for/dylan_fan/***
git push ssh://hai_li@dev.ppcam.tv:29418/esp/core HEAD:refs/for/master


git push origin HEAD:refs/for/master
git push origin HEAD:refs/for/ab210-stable-1.0

git config --global user.name dylan_fan
git config --global user.email dylan_fan@above-link.com
git commit --amend --reset-author
git reset HEAD^1 product/ESP2/version
git commit --amemd

常用测试命令

当内核被破坏时，同时tftp无法启动，这个时候可以使用loadx模式下载内核或bootstrap。

sntp -s -t 1 time.nist.gov ##获取时间
修改时区命令：
echo "GMT+0" > /tmp/conf/timezoneInotify file
sh /etc/init.d/S03timezone
echo GMT+8 > /conf/timezone
修改配置文件，调试不能上线的问题
1.mp/xmpp,sn,mac
2.修改xmpp username，key
3.tar czvf mp.tgz mp
4.dd if=/dev/zero of=/dev/mtdblock5 count=512 bs=1k
5.dd if=mp.tgz of=/dev/mtdblock6

在配置无线的丢失的时候可能会用上：
dbus-send --system --type=signal /com/ezcamera/NM com.ezcamera.NM.AddWirelessProfile string:wl_QA_test_214 string:abovelink214

tcpdump命令：
./tcpdump -i ra0 -X src host eye.ppcam.tv
./tcpdump -i eth0 -X host cn1.ppcam.tv


监测接受到的无线强度;
iwpriv ra0 get_site_survey

想GPIO写数据（zwave reset）：
echo 3 > /sys/class/gpio/export
echo out > /sys/class/gpio/gpio3/direction
输出高：
echo 1 > /sys/class/gpio/gpio3/value
输出低：
echo 0 > /sys/class/gpio/gpio3/value

恢复Zwave模块到出厂设置（重新分配Home ID）：
erase,清空所有:zwave 节点
dbus-send --system --type=signal /com/ezcamera/UA com.ezcamera.MINOZW.UA_SIGNAL_ZWAVE_NEW string:erase int32:10 string:0

dbus-send --system --type=signal /com/ezcamera/UA com.ezcamera.MINOZW.UA_SIGNAL_ZWAVE_NEW string:CR1 int32:4 string:6
需要另外执行：
rm zw*
rm defence.xml
rm scene_list.xml
rm association.xml


无线配置不成功：
1.网卡驱动没有弄好，现在有两种网卡型号
2.rootfs中没有将对应的配置项弄进去

测试IR：
获取所有IR控制器对应的设备列表：
dbus-send --system --type=signal /com/ezcamera/UA com.ezcamera.MINOZW.UA_SIGNAL_ZWAVE_IR string:IR1 int32:0 int32:0

学习一个IR key
dbus-send --system --type=signal /com/ezcamera/UA com.ezcamera.MINOZW.UA_SIGNAL_ZWAVE_IR string:IR1 int32:1 int32:3
发送一个IR key（红外控制）
dbus-send --system --type=signal /com/ezcamera/UA com.ezcamera.MINOZW.UA_SIGNAL_ZWAVE_IR string:IR1 int32:2 int32:3

wget  http://dev.ppcam.tv/dl/lihai/tmp/minozw

nc 218.206.129.214 10000 <out.txt
wget ftp://218.206.129.214/ftp/minozw

测试新的板子：
要示波器
433的，问客户端要个门锁客户端
用串口测试：
1.锁
dbus-send --system --type=signal /com/ezcamera/UA com.ezcamera.UA.UA_SIGNAL_DOORLOCK_OPERA int32:0
2.开
dbus-send --system --type=signal /com/ezcamera/UA com.ezcamera.UA.UA_SIGNAL_DOORLOCK_OPERA int32:1
3.备用
dbus-send --system --type=signal /com/ezcamera/UA com.ezcamera.UA.UA_SIGNAL_DOORLOCK_OPERA int32:2
4.备用
dbus-send --system --type=signal /com/ezcamera/UA com.ezcamera.UA.UA_SIGNAL_DOORLOCK_OPERA int32:3

门锁的固件目录：
ftp://dev.ppcam.tv/jiangping/doorlock/

485接线：5V对5V，0V对0V

http://www.z-wavealliance.org/login
http://zts.sigmadesigns.com/getting-started

http://zts.sigmadesigns.com/z-wave-technical-service?destination=/



##代码规范
indent -kr -ts4 -i4 -l100


